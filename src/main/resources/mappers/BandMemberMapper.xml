<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="mappers.BandMemberMapper">

    <insert id="insertOne" parameterType="BandMember" useGeneratedKeys="true" keyProperty="no">
        INSERT INTO band_member (id, name, nickname, role, approved, joined_at)
        VALUES (#{id}, #{name}, #{nickname}, #{role}, #{approved}, #{joined_at})
    </insert>

    <!-- 밴드 번호로 모든 멤버 조회 -->
    <select id="selectByBandNo" parameterType="int" resultType="BandMember">
        SELECT no, band_no, member_id, role, approved, joined_at
        FROM band_member
        WHERE band_no = #{band_no}
        ORDER BY joined_at DESC;
    </select>

    <!-- 특정 멤버가 속한 밴드 조회 -->
    <select id="selectByMemberId" parameterType="String" resultType="BandMember">
        SELECT no, band_no, member_id, role, approved, joined_at
        FROM band_member
        WHERE id = #{bandId};
    </select>

    <!-- 승인 상태 변경 -->
    <update id="updateApproval" parameterType="BandMember">
        UPDATE band_member
        SET approved = #{approved}
        WHERE no = #{bandNo};
    </update>


    <!-- 밴드 멤버 삭제 -->
    <delete id="deleteByMemberId" parameterType="String">
        DELETE FROM band_member
        WHERE no = #{bandNo};
    </delete>

</mapper>
